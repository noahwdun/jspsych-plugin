var jsPsychPluginMovingDots2=function(a){"use strict";var k="0.0.1";const D={name:"plugin-moving-dots-2",version:k,parameters:{control_levels:{type:a.ParameterType.INT,array:!0,default:[30,70,100]},dot_count:{type:a.ParameterType.INT,default:10},max_initial_distance:{type:a.ParameterType.INT,default:100},flash_duration:{type:a.ParameterType.INT,default:200},pre_flash_duration:{type:a.ParameterType.INT,default:2500},post_flash_duration:{type:a.ParameterType.INT,default:1500},trial_duration:{type:a.ParameterType.INT,default:5e3},initial_control_level:{type:a.ParameterType.INT,default:100},control_change_level:{type:a.ParameterType.INT,default:30},playback:{type:a.ParameterType.COMPLEX,array:!0,default:[],params:{dx:{type:a.ParameterType.INT},dy:{type:a.ParameterType.INT},t:{type:a.ParameterType.INT}}}},data:{control_change:{type:a.ParameterType.INT}},citations:"__CITATIONS__"};class P{constructor(m){this.jsPsych=m}trial(m,r){const e=document.createElement("canvas");e.width=800,e.height=600,m.appendChild(e);const o=e.getContext("2d"),i=[],c=0,f=r.control_change_level;let v=null,s=!1,h=!1;const g=[];let u=0,E=Date.now(),y=0,T=0;const C=()=>{for(let t=0;t<r.dot_count;t++){const n=Math.random()*2*Math.PI,l=Math.random()*r.max_initial_distance;i.push({x:e.width/2+l*Math.cos(n),y:e.height/2+l*Math.sin(n),control:r.initial_control_level})}},w=()=>{o.clearRect(0,0,e.width,e.height),o.beginPath(),o.moveTo(e.width/2-10,e.height/2),o.lineTo(e.width/2+10,e.height/2),o.moveTo(e.width/2,e.height/2-10),o.lineTo(e.width/2,e.height/2+10),o.strokeStyle="black",o.lineWidth=2,o.stroke(),i.forEach((t,n)=>{o.beginPath(),o.arc(t.x,t.y,5,0,2*Math.PI),h?o.fillStyle=n===c?"red":"black":o.fillStyle="black",o.fill()})},I=t=>{y=t.movementX,T=t.movementY},L=(t,n,l,_,d)=>{const p=Math.sqrt(Math.pow(t,2)+Math.pow(n,2))+1e-5,N={x:t/p,y:n/p},x=Math.sqrt(Math.pow(l,2)+Math.pow(_,2))+1e-5,b={x:l/x,y:_/x},X=(d*N.x+(1-d)*b.x)*p,A=(d*N.y+(1-d)*b.y)*p;return{newDX:X,newDY:A}},S=(t,n)=>{i.forEach(l=>{const{newDX:_,newDY:d}=L(t,n,r.playback[u].dx,r.playback[u].dy,l.control/100);l.x+=_,l.y+=d})},q=()=>{document.removeEventListener("mousemove",I),m.innerHTML="",this.jsPsych.finishTrial({control_change:f,mouse_data:g})},M=()=>{const t=Date.now(),n=t-E;if(n>=r.trial_duration){q();return}h&&t-v>=r.flash_duration&&(h=!1,s=!0),n>=r.pre_flash_duration&&!h&&!s&&(v=Date.now(),h=!0,r.initial_control_level===100?i[c].control=i[c].control-f:r.initial_control_level===0&&(i[c].control=i[c].control+f)),S(y,T),w(),g.push({dx:y,dy:T,elapsedTime:n,frame:u}),y=0,T=0,u++,requestAnimationFrame(M)};C(),w(),document.addEventListener("mousemove",I),M()}}return P.info=D,P}(jsPsychModule);
//# sourceMappingURL=index.browser.min.js.map
