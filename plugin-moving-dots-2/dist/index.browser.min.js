var jsPsychPluginMovingDots2=function(n){"use strict";var k="0.0.1";const D={name:"plugin-moving-dots-2",version:k,parameters:{control_levels:{type:n.ParameterType.INT,array:!0,default:[30,70,100]},dot_count:{type:n.ParameterType.INT,default:10},max_initial_distance:{type:n.ParameterType.INT,default:100},flash_duration:{type:n.ParameterType.INT,default:200},pre_flash_duration:{type:n.ParameterType.INT,default:2500},post_flash_duration:{type:n.ParameterType.INT,default:1500},initial_control_level:{type:n.ParameterType.INT,default:100},control_change_level:{type:n.ParameterType.INT,default:30},playback:{type:n.ParameterType.COMPLEX,array:!0,default:[],params:{dx:{type:n.ParameterType.INT},dy:{type:n.ParameterType.INT},t:{type:n.ParameterType.INT}}}},data:{control_change:{type:n.ParameterType.INT}},citations:"__CITATIONS__"};class f{constructor(m){this.jsPsych=m}trial(m,o){const e=document.createElement("canvas");e.width=window.innerWidth,e.height=window.innerHeight,m.appendChild(e);const a=e.getContext("2d"),i=[],h=0,p=o.control_change_level;let P=null,v=!1,c=!1;const w=[];let T=0,E=Date.now(),_=0,u=0;const C=()=>{for(let t=0;t<o.dot_count;t++){const r=Math.random()*2*Math.PI,l=Math.random()*o.max_initial_distance;i.push({x:e.width/2+l*Math.cos(r),y:e.height/2+l*Math.sin(r),control:o.initial_control_level})}},g=()=>{a.clearRect(0,0,e.width,e.height),a.beginPath(),a.moveTo(e.width/2-10,e.height/2),a.lineTo(e.width/2+10,e.height/2),a.moveTo(e.width/2,e.height/2-10),a.lineTo(e.width/2,e.height/2+10),a.strokeStyle="black",a.lineWidth=2,a.stroke(),i.forEach((t,r)=>{a.beginPath(),a.arc(t.x,t.y,5,0,2*Math.PI),c?a.fillStyle=r===h?"red":"black":a.fillStyle="black",a.fill()})},I=t=>{_=t.movementX,u=t.movementY},L=(t,r,l,y,d)=>{const s=Math.sqrt(Math.pow(t,2)+Math.pow(r,2))+1e-5,x={x:t/s,y:r/s},N=Math.sqrt(Math.pow(l,2)+Math.pow(y,2))+1e-5,b={x:l/N,y:y/N},X=(d*x.x+(1-d)*b.x)*s,A=(d*x.y+(1-d)*b.y)*s;return{newDX:X,newDY:A}},S=(t,r)=>{i.forEach(l=>{const{newDX:y,newDY:d}=L(t,r,o.playback[T].dx,o.playback[T].dy,l.control/100);l.x+=y,l.y+=d})},q=()=>{document.removeEventListener("mousemove",I),m.innerHTML="",this.jsPsych.finishTrial({control_change:p,mouse_data:w})},M=()=>{const t=Date.now(),r=t-E;if(r>=o.pre_flash_duration+o.post_flash_duration){q();return}c&&t-P>=o.flash_duration&&(c=!1,v=!0),r>=o.pre_flash_duration&&!c&&!v&&(P=Date.now(),c=!0,o.initial_control_level===100?i[h].control=i[h].control-p:o.initial_control_level===0&&(i[h].control=i[h].control+p)),S(_,u),g(),w.push({dx:_,dy:u}),_=0,u=0,T++,requestAnimationFrame(M)};C(),g(),document.addEventListener("mousemove",I),M()}}return f.info=D,f}(jsPsychModule);
//# sourceMappingURL=index.browser.min.js.map
