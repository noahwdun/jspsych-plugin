var jsPsychPluginMovingDots2=function(d){"use strict";var D="0.0.1";const S={name:"plugin-moving-dots-2",version:D,parameters:{max_initial_distance:{type:d.ParameterType.INT,default:100},flash_duration:{type:d.ParameterType.INT,default:200},pre_flash_duration:{type:d.ParameterType.INT,default:2500},post_flash_duration:{type:d.ParameterType.INT,default:1500},initial_control_level:{type:d.ParameterType.INT,default:100},control_change_level:{type:d.ParameterType.INT,default:30},diode_heights:{type:d.ParameterType.INT,array:!0,default:[10,70,130,190]},playback:{type:d.ParameterType.COMPLEX,array:!0,default:[],params:{dx:{type:d.ParameterType.INT},dy:{type:d.ParameterType.INT},t:{type:d.ParameterType.INT}}}},data:{control_change:{type:d.ParameterType.INT}},citations:"__CITATIONS__"};class k{constructor(v){this.jsPsych=v}trial(v,i){const e=document.createElement("canvas");e.width=window.innerWidth,e.height=window.innerHeight,v.appendChild(e);const a=e.getContext("2d"),u=[],_=0,T=i.control_change_level;let P=null,C=!1,x=!1;const M=[];let w=0,$=Date.now(),f=0,b=0;const L=()=>{for(let t=0;t<10;t++){const o=Math.random()*2*Math.PI,h=Math.random()*i.max_initial_distance;u.push({x:e.width/2+h*Math.cos(o),y:e.height/2+h*Math.sin(o),control:i.initial_control_level})}},I=()=>{a.clearRect(0,0,e.width,e.height),a.beginPath(),a.moveTo(e.width/2-10,e.height/2),a.lineTo(e.width/2+10,e.height/2),a.moveTo(e.width/2,e.height/2-10),a.lineTo(e.width/2,e.height/2+10),a.strokeStyle="black",a.lineWidth=2,a.stroke(),u.forEach((t,o)=>{a.beginPath(),a.arc(t.x,t.y,5,0,2*Math.PI),x?a.fillStyle=o===_?"red":"black":a.fillStyle="black",a.fill()})},E=t=>{f=t.movementX,b=t.movementY},q=(t,o,h,l,n)=>{const r=Math.sqrt(Math.pow(t,2)+Math.pow(o,2))+1e-5,c={x:t/r,y:o/r},y=Math.sqrt(Math.pow(h,2)+Math.pow(l,2))+1e-5,s={x:h/y,y:l/y},p=(n*c.x+(1-n)*s.x)*r,m=(n*c.y+(1-n)*s.y)*r;return{newDX:p,newDY:m}},z=(t,o)=>{u.forEach(h=>{const{newDX:l,newDY:n}=q(t,o,i.playback[w].dx,i.playback[w].dy,h.control/100);h.x+=l,h.y+=n})},X=()=>{document.exitPointerLock(),e.removeEventListener("mousemove",E),v.innerHTML="",this.jsPsych.finishTrial({control_change:T,mouse_data:M})};function A(t,o,h,l){const n=document.createElement("div"),r=document.createElement("div"),c=document.createElement("div"),y=document.createElement("div"),s=document.createElement("div"),p=document.createElement("div"),m=document.createElement("div"),g=document.createElement("div");n.style.position="fixed",n.style.bottom=`${l[0]}px`,n.style.right="10px",n.style.height="5vh",n.style.width="5vh",n.style.backgroundColor="black",r.style.position="fixed",r.style.bottom=`${l[1]}px`,r.style.right="10px",r.style.height="5vh",r.style.width="5vh",r.style.backgroundColor="black",c.style.position="fixed",c.style.bottom=`${l[2]}px`,c.style.right="10px",c.style.height="5vh",c.style.width="5vh",c.style.backgroundColor="black",y.style.position="fixed",y.style.bottom=`${l[3]}px`,y.style.right="10px",y.style.height="5vh",y.style.width="5vh",y.style.backgroundColor=h?"white":"black",h&&(n.style.backgroundColor=t===100?"white":"black",r.style.backgroundColor=o===30?"white":"black",c.style.backgroundColor=o===70?"white":"black"),s.style.position="fixed",s.style.bottom=`${l[0]+35}px`,s.style.right="10px",s.style.fontSize="12px",s.innerText="initial",p.style.position="fixed",p.style.bottom=`${l[1]+35}px`,p.style.right="10px",p.style.fontSize="12px",p.innerText="change1",m.style.position="fixed",m.style.bottom=`${l[2]+35}px`,m.style.right="10px",m.style.fontSize="12px",m.innerText="change2",g.style.position="fixed",g.style.bottom=`${l[3]+35}px`,g.style.right="10px",g.style.fontSize="12px",g.innerText="flash",document.body.appendChild(n),document.body.appendChild(r),document.body.appendChild(c),document.body.appendChild(y),document.body.appendChild(s),document.body.appendChild(p),document.body.appendChild(m),document.body.appendChild(g)}const N=()=>{const t=Date.now(),o=t-$;if(o>=i.pre_flash_duration+i.post_flash_duration){X();return}x&&t-P>=i.flash_duration&&(x=!1,C=!0),o>=i.pre_flash_duration&&!x&&!C&&(P=Date.now(),x=!0,i.initial_control_level===100?u[_].control=u[_].control-T:i.initial_control_level===0&&(u[_].control=u[_].control+T)),A(i.initial_control_level,i.control_change_level,x,i.diode_heights),z(f,b),I(),M.push({dx:f,dy:b}),f=0,b=0,w++,requestAnimationFrame(N)};L(),I(),e.requestPointerLock({unadjustedMovement:!1}),e.addEventListener("mousemove",E),N()}}return k.info=S,k}(jsPsychModule);
//# sourceMappingURL=index.browser.min.js.map
